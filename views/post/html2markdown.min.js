!function(a,b){if("function"==typeof define)define(b);else if("undefined"!=typeof module&&module.exports)module.exports=b();else{var c=b(),d=this,e=d[a];c.noConflict=function(){return d[a]=e,c},d[a]=c}}("html2markdown",function(){function a(a){return a.replace(/^\s+|\s+$/g,"")}function b(a,b){return a.match(b+"$")==b}function c(a,b){return 0==a.indexOf(b)}function d(d,e){function f(){var a="";if(o)for(var b=0;b<o.length-1;b++)a+="  ";return a+=h(o)}function g(a){var b={};for(var c in a){var d=a[c];b[d.name]=d}return b}function h(a){return a&&a.length>0?a.slice(-1)[0]:""}function i(a){if(!a)return"";for(var b=a.length-1;b>=0;b--)if(""!=a[b])return a[b];return""}function j(a){var b=!1;if(a==i(n)){for(;h(n)!=a;)n.pop();n.pop(),b=!0}return b}function k(a){for(var b=[];n.length>0&&h(n)!=a;){var c=n.pop();b.unshift(c)}return b.join("")}function l(a){var c=n.pop();if(c)if(a)n.push(c),b(c,"\n")||n.push("\n\n");else{var d;/\s*\n\n\s*$/.test(c)?(c=c.replace(/\s*\n\n\s*$/,"\n\n"),d=""):/\s*\n\s*$/.test(c)?(c=c.replace(/\s*\n\s*$/,"\n"),d="\n"):d=/\s+$/.test(c)?"\n\n":"\n\n",n.push(c),n.push(d)}}function m(){if(n.length>0){var a=h(n);b(a,"\n")||n.push("\n")}else n.push("\n")}e=e||{};var n=[],o=[],p=[],q=[],r=[],s=[],t=e.inlineStyle||!1,u=e.parser,v={hr:"- - -\n\n",br:"  \n",title:"# ",h1:"# ",h2:"## ",h3:"### ",h4:"#### ",h5:"##### ",h6:"###### ",b:"**",strong:"**",i:"_",em:"_",dfn:"_","var":"_",cite:"_",span:" ",ul:"* ",ol:"1. ",dl:"- ",blockquote:"> "};if(u||"undefined"==typeof markdownDOMParser||(u=markdownDOMParser),u(d,{start:function(b,d,e){if(b=b.toLowerCase(),!e||"br"==b||"hr"==b||"img"==b)switch(b){case"br":n.push(v[b]);break;case"hr":l(),n.push(v[b]);break;case"title":case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":l(),n.push(v[b]);break;case"b":case"strong":case"i":case"em":case"dfn":case"var":case"cite":n.push(v[b]);break;case"code":case"span":if(r.length>0)break;/\s+$/.test(h(n))||n.push(v[b]);break;case"p":case"div":case"table":case"tbody":case"tr":case"td":l();break;case"ul":case"ol":case"dl":o.push(v[b]),o.length>1?m():l();break;case"li":case"dt":var j=f();n.push(j);break;case"a":var k=g(d);p.push(k),n.push("[");break;case"img":var u,w,x,k=g(d);if(x=k.src?k.src.value:"",!x)break;if(u=k.alt?a(k.alt.value):"",w=k.title?a(k.title.value):"",t||c(i(n),"["))c(i(n),"[")||l(),n.push("!["+u+"]("+x+(w?' "'+w+'"':"")+")"),c(i(n),"[")||l(!0);else{var y=s.indexOf(x);-1==y&&(s.push(x),y=s.length-1),l(),n.push("!["),""!=u?n.push(u):null!=w&&n.push(w),n.push("]["+y+"]"),l()}break;case"blockquote":l(),q.push(v[b]);break;case"pre":l(),r.push(!0),n.push("    ");break;case"table":n.push("<table>");break;case"thead":n.push("<thead>");break;case"tbody":n.push("<tbody>");break;case"tr":n.push("<tr>");break;case"td":n.push("<td>")}},chars:function(b){if(r.length>0)b=b.replace(/\n/g,"\n    ");else{if(""==a(b))return void n.push("");b=b.replace(/\s+/g," ");var c=i(n);/\s+$/.test(c)&&(b=b.replace(/^\s+/g,""))}q.length>0&&n.push(q.join("")),n.push(b)},end:function(b){switch(b=b.toLowerCase()){case"title":case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":j(v[b])||l(!0);break;case"p":case"div":case"table":case"tbody":case"tr":case"td":for(;n.length>0&&""==a(h(n));)n.pop();l(!0);break;case"b":case"strong":case"i":case"em":case"dfn":case"var":case"cite":j(v[b])||(n.push(a(k(v[b]))),n.push(v[b]));break;case"a":var d=k("[");if(d=d.replace(/\s+/g," "),d=a(d),""==d){n.pop();break}var e,g=p.pop();if(e=g.href&&""!=g.href.value?g.href.value:"",""==e){n.pop(),n.push(d);break}if(n.push(d),t||c(h(n),"!")){if(c(h(n),"!")){var d=n.pop();d=n.pop()+d,l(),n.push(d)}var i=g.title;n.push("]("+e+(i?' "'+a(i.value).replace(/\s+/g," ")+'"':"")+")"),c(h(n),"!")&&l(!0)}else{var u=s.indexOf(e);-1==u&&(s.push(e),u=s.length-1),n.push("]["+u+"]")}break;case"ul":case"ol":case"dl":m(),o.pop();break;case"li":case"dt":var w=f();if(!j(w)){var d=a(k(w));c(d,"[![")?(n.pop(),l(),n.push(d),l(!0)):(n.push(d),m())}break;case"blockquote":q.pop();break;case"pre":l(!0),r.pop();break;case"code":case"span":if(r.length>0)break;if(""==a(h(n)))n.pop(),n.push(v[b]);else{var d=n.pop();n.push(a(d)),n.push(v[b])}break;case"table":n.push("</table>");break;case"thead":n.push("</thead>");break;case"tbody":n.push("</tbody>");break;case"tr":n.push("</tr>");break;case"td":n.push("</td>");break;case"br":case"hr":case"img":}}},{nodesToIgnore:["script","noscript","object","iframe","frame","head","style","label"]}),!t)for(var w=0;w<s.length;w++)if(0==w){var x=n.pop();n.push(x.replace(/\s+$/g,"")),n.push("\n\n["+w+"]: "+s[w])}else n.push("\n["+w+"]: "+s[w]);return n.join("")}return d});